# 航冠國際聯運有限公司 - 數位轉型專案文件

> **最後更新日期：** 2025-01-XX  
> **專案代號：** RHEMA Digital Transformation  
> **文件目的：** 提供完整的公司資訊、組織架構、技術架構與開發計劃，確保在任何環境下都能快速銜接專案進度

---

## 📋 目錄

1. [公司基本資訊](#公司基本資訊)
2. [組織架構](#組織架構)
3. [技術環境與帳號資訊](#技術環境與帳號資訊)
4. [專案願景與目標](#專案願景與目標)
5. [開發計劃與階段](#開發計劃與階段)
6. [技術架構決策](#技術架構決策)
7. [Microsoft 365 整合資訊](#microsoft-365-整合資訊)
8. [常見問題與解答](#常見問題與解答)
9. [開發進度追蹤](#開發進度追蹤)

---

## 🏢 公司基本資訊

### 公司資料
- **公司全名：** 航冠國際聯運有限公司
- **統一編號：** 53514268
- **所在地：** 台灣台中
- **主要業務：** 貨物承攬業（貨代業、船務、FORWARD、FWD）
- **官方網站：** http://www.rhema.url.tw/ （目前為租用一頁式架網頁，需重新設計並轉移至自有網域）

### 公司網域
- **自有網域：** rhema.com.tw
- **網域狀態：** 已擁有，待配置使用

### 業務範圍
根據官網資訊，服務地區包括：
- 台灣：北部、中部、南部
- 國際：港澳、大陸、東南亞、日韓
- 全球主要港口均有服務據點

### 分公司據點
- **台中總公司：** 台中市南區忠明南路789號17樓之2
- **台北分公司：** 航亞國際聯運有限公司（台北市中山區新生北路三段93巷44號1樓）
- **深圳分公司：** 航加國際貨運代理有限公司
- **上海分公司：** 航加國際貨運代理有限公司
- **其他據點：** 香港、廣州、廈門、寧波、天津、越南

---

## 👥 組織架構

### 部門劃分
公司主要分為三個核心部門：

1. **業務部門**
   - 負責客戶開發與維護
   - 報價與業務洽談
   - 需要追蹤個人出貨數據與成就

2. **OP 部門（營運部門）**
   - 負責船務操作
   - 目前使用「全中資訊」開發的船務系統
   - 需要新的網頁版船務系統

3. **會計部門**
   - 負責財務管理
   - 請款單審核與額度管理
   - 需要後台管理功能

### 權限需求
- **一般員工：** 使用請款系統、查看個人儀表板
- **會計人員：** 設定請款額度、查看請款總覽、後台管理
- **系統管理員：** 完整系統管理權限

---

## 💻 技術環境與帳號資訊

### Microsoft 365 訂閱
- **方案：** Microsoft 365 Business Basic
- **訂閱狀態：** 全公司每人皆有訂閱
- **租用戶：** 航冠國際聯運有限公司
- **整合策略：** 盡可能發揮訂閱效益，但以專業判斷為準，不為串接而串接

### 開發者帳號
- **個人信箱（Git/Vercel）：** rhemaluis125@gmail.com
- **公司信箱：** ivan.chen@rhema.com.tw 正確
- **GitHub 帳號：** https://github.com/RheC1e
- **GitHub 使用者名稱：** RheC1e

### 部署平台
- **主要平台：** Vercel
- **Vercel 網址：** https://rhema-pwa-demo.vercel.app
- **Git 倉庫：** GitHub (https://github.com/RheC1e/rhema-pwa-demo)
- **GitHub Token：** 已設定（儲存在本地 `.env.local`，不會提交到 Git）
- **自動部署：** 已啟用（Vercel 連接 Git 倉庫，推送即自動部署）

---

## 🎯 專案願景與目標

### 核心願景
打造一個**全面性的公司數位化系統**，不僅是工具，更是：
- **遊戲化的工作環境**：以周郁凱的八角遊戲化框架為理論基底
- **數據驅動的成長平台**：讓每個員工都能看到自己的成就與進步
- **雲端化的現代系統**：解決跨平台、跨地點、跨時間的限制

### 設計理念
1. **以「紀錄與成就」取代冰冷 KPI**
2. **強調遊戲化體驗**：勳章、成就牆、個人頁面
3. **資料與服務雲端化**：隨處可用、隨時可用
4. **完美串接與運用數據**：避免二次做工、數據浪費

---

## 📅 開發計劃與階段

### 階段一：請款系統（優先開發）✅ 進行中

#### 目標
取代現有的 Google 試算表請款單，建立網頁版請款系統。

#### 功能需求
1. **請款單填寫**
   - 日期選擇器
   - 項目選擇：**油資、交際費、其他（打在備註）**
   - 金額輸入
   - 備註說明
   - 多筆記錄新增/刪除

2. **請款規則**
   - 自動計算各項目小計與總計
   - **限額功能：** 第一階段先不做，待系統穩定運作後再實作

3. **PDF 輸出功能**
   - 輸出請款單為 PDF
   - 設計重點：數據清晰、適合會計閱讀（不需像網頁一樣漂亮）

4. **介面要求**
   - 符合圖二～圖四的設計風格
   - 登入功能（同一頁面，不開新頁面）
   - PWA 支援（可下載為 APP）
   - Teams 應用程式版本（點開自動用 Teams 登入）
   - 完美自適應（響應式設計）

5. **權限管理**
   - **第一階段：** 先不做權限管理，確認系統正常運作
   - **第二階段：** 會計可查看所有請款單總覽
   - **第三階段：** 會計可設定每個業務的請款額度、後台管理入口

#### 技術要求
- **前端：** PWA、響應式設計
- **後端：** 待決定（見技術架構決策）
- **認證：** Microsoft 365 SSO
- **部署：** Vercel（自動部署）
- **資料庫：** 第一階段先使用簡單方案（如 localStorage 或 SharePoint List），待系統穩定後再擴充

#### 開發策略（分階段進行）
1. **第一階段：** 核心功能開發
   - Microsoft 365 登入整合
   - 請款單基本功能（新增、刪除、計算）
   - PDF 輸出功能
   - PWA 與響應式設計
   - Teams 應用程式版本
   - **不包含：** 權限管理、限額功能、資料庫（先用簡單方案）

2. **第二階段：** 權限與資料庫
   - 權限管理系統
   - 會計後台功能
   - 資料庫整合（SharePoint List 或替代方案）

3. **第三階段：** 進階功能
   - 限額功能
   - 數據分析與報表

#### 入口介面（簡單版）
- 基本導航功能
- 連接到請款介面
- 權限判斷顯示不同功能

---

### 階段二：個人儀表板與遊戲化系統

#### 目標
建立 Steam 風格的個人檔案頁面，展示成就、勳章、數據。

#### 功能需求
1. **個人檔案頁面**
   - 展示基本資訊
   - 成就牆
   - 勳章展示
   - 數據視覺化

2. **成就系統（範例）**
   - 「東南亞皇帝」：至少做過東南亞 15 個不同港口的貨
   - 「一票之重」：單票出貨超過 20 TEU
   - 更多成就待設計...

3. **數據來源**
   - 需串接船務系統才能取得業務出貨資訊
   - 暫時可用模擬數據展示介面

---

### 階段三：船務系統開發

#### 背景
- **現有系統：** 全中資訊開發的船務系統
- **問題：**
  - 20 年前購買，只支援 Windows XP
  - 支援 Win 10+ 的升級費用過高
  - 廠商配合狀況不佳、收費不合理
  - 目前使用 5 萬元電腦灌十幾台 XP 模擬器讓 OP 遠端使用
  - 主機故障會導致全 OP 無法工作

#### 替代方案評估
- **良美資訊系統：**
  - 優點：開發人員具備船務、會計專業，流程與介面設計佳，可提供 API
  - 缺點：仍為桌面程式、需公司內主機、系統較封閉

#### 自研系統需求
1. **技術要求**
   - 網頁版（解決跨平台問題）
   - 雲端部署（公司不再需要硬體主機）
   - 介面美觀、符合期望
   - 可嘗試新的操作邏輯與交互界面

2. **數據整合**
   - 完美串接與運用數據
   - 與 CRM、會計系統、國外分公司連接
   - 避免二次做工

3. **功能範圍**
   - 取代全中系統的所有核心功能
   - 整合會計功能（或與會計系統完美串接）
   - 報表輸出與數據分析

---

### 階段四：官網重新設計

#### 目標
美化並重新設計官網，轉移至自有網域。

#### 需求
- **設計：** 現代化、美觀
- **網域：** 轉移至 rhema.com.tw
- **部署：** 待決定（Vercel 或其他）
- **內容：** 保留現有資訊，優化呈現方式

---

## 🏗️ 技術架構決策

### 前端技術
- **框架：** 待決定（建議：React/Vue.js）
- **PWA：** 必須支援
- **響應式設計：** 必須完美自適應
- **Teams 整合：** 需支援 Teams 應用程式格式

### 後端技術
- **待決定：** 需評估需求後決定

### 資料庫方案

#### 選項一：SharePoint List
- **優點：**
  - 已包含在 Microsoft 365 Basic 方案中
  - 無需額外費用
  - 與 Microsoft 365 生態系統整合良好
  - 有權限管理功能

- **缺點：**
  - 效能可能不如專業資料庫
  - 複雜查詢可能有限制
  - 不適合高併發場景

#### 選項二：雲端資料庫（如 Vercel Postgres、Supabase）
- **優點：**
  - 效能較佳
  - 支援複雜查詢
  - 有免費方案可開始

- **缺點：**
  - 可能需要額外費用（超過免費額度後）
  - 需額外管理

#### 選項三：混合方案
- 簡單數據用 SharePoint List
- 複雜數據用雲端資料庫

**建議：** 先從 SharePoint List 開始，若效能不足再遷移至雲端資料庫。

---

### 雲端主機需求

#### Vercel 說明
- **為什麼免費：** Vercel 提供免費方案給個人/小專案使用
- **限制：** 有使用量限制，但對初期開發足夠
- **付費方案：** 當專案成長後可考慮升級

#### 是否需要租雲端主機？
**初期：不需要**
- Vercel 免費方案足夠初期開發
- SharePoint List 作為資料庫（無需額外主機）
- Microsoft 365 服務已包含

**後期：視需求決定**
- 若使用量超過 Vercel 免費額度
- 若需要專用資料庫服務
- 若需要更強大的後端服務

---

## 🔐 Microsoft 365 整合資訊

### 應用程式註冊資訊
- **應用程式名稱：** RHEMA 請款系統
- **應用程式識別碼（Client ID）：** `33abd69a-d012-498a-bddb-8608cbf10c2d`
- **物件識別碼（Object ID）：** `10e06464-823a-4262-a025-a54d564fce69`
- **租用戶識別碼（Tenant ID）：** `cd4e36bd-ac9a-4236-9f91-a6718b6b5e45`
- **應用程式識別碼 URI：** `api://pwa-demo-ten-sable.vercel.app/33abd69a-d012-498a-bddb-8608cbf10c2d`

### 支援的帳戶類型
- **僅我的組織（My organization only）**
- 只有航冠國際聯運有限公司租用戶內的用戶可以登入

### 重新導向 URI
- **SPA（Single-Page Application）：** 需要新增以下 URI
  - `http://localhost:3000`（本地開發）
  - `http://localhost:5173`（本地開發替代埠）
  - `https://rhema-pwa-demo.vercel.app`（Vercel 生產環境）✅ **必須新增**
- **Web：** 0 個
- **公用用戶端：** 0 個

**⚠️ 重要：** 部署到 Vercel 後，必須在 Azure Portal 中新增 Vercel 網址作為 Redirect URI，否則登入會失敗。詳細步驟請參考 `AZURE_REDIRECT_URI_SETUP.md`。

### API 權限（已授與）
所有權限皆為「已委派（Delegated）」類型，且已獲得管理員同意：

1. **email**
   - 類型：已委派
   - 描述：View users' email address
   - 需要管理員同意：否

2. **GroupMember.Read.All**
   - 類型：已委派
   - 描述：Read group memberships
   - 需要管理員同意：是 ✅

3. **profile**
   - 類型：已委派
   - 描述：View users' basic profile
   - 需要管理員同意：否

4. **User.Read**
   - 類型：已委派
   - 描述：Sign in and read user profile
   - 需要管理員同意：否

5. **User.ReadBasic.All**
   - 類型：已委派
   - 描述：Read all users' basic profiles
   - 需要管理員同意：是 ✅

### 重要提醒
- **已棄用技術：** ADAL 與 Azure AD Graph 已不再更新，應使用 MSAL 與 Microsoft Graph
- **建議使用：** Microsoft Authentication Library (MSAL) 與 Microsoft Graph API

---

## ❓ 常見問題與解答

### Q1: 船務系統架在網頁是否跑的動？是否會一直有載入緩衝？能否像桌面程式一樣反應迅速？

**A:** 
- **技術上可行：** 現代網頁技術（React、Vue.js 等）配合適當的架構設計，完全可以達到接近桌面程式的反應速度
- **優化策略：**
  - 使用前端框架的虛擬化技術處理大量數據
  - 實作資料快取與本地儲存
  - 使用 Service Worker 進行離線支援
  - 採用增量載入與分頁技術
  - 使用 WebSocket 進行即時更新
- **實際案例：** 許多大型企業系統（如 Salesforce、Microsoft 365）都是網頁版，反應速度優秀
- **建議：** 先開發 MVP（最小可行產品）測試效能，再根據實際使用情況優化

### Q1-1: 能及時更新嗎？像是另位 OP 更改某票出貨資訊，另位 OP 就能即時更新？

**A:**
- **完全可以！** 現代網頁技術支援即時更新，有多種方案：
  1. **WebSocket：** 最適合即時雙向通訊
     - 當一位 OP 修改資料時，伺服器立即推送更新給所有連線的用戶
     - 反應速度極快（毫秒級）
     - 適合需要即時協作的場景
  2. **Server-Sent Events (SSE)：** 單向即時推送
     - 伺服器主動推送更新給客戶端
     - 比 WebSocket 簡單，但只能單向
  3. **輪詢（Polling）：** 定期檢查更新
     - 最簡單但效率較低
     - 適合更新頻率不高的場景
- **建議方案：** 使用 WebSocket 或 SSE，配合前端狀態管理（如 Redux、Vuex），確保所有用戶看到最新資料
- **實際案例：** Google Docs、Notion 等協作工具都是網頁版，支援多人即時編輯

---

### Q2: 有無可能用目前訂閱方案的 SharePoint List 當資料庫？還是更建議資料庫如何解決？

**A:**
- **可以使用 SharePoint List：**
  - ✅ 已包含在 Microsoft 365 Basic 方案中
  - ✅ 無需額外費用
  - ✅ 與 Microsoft 365 整合良好
  - ✅ 有權限管理功能
  - ⚠️ 效能可能不如專業資料庫（但對中小型企業通常足夠）
  - ⚠️ 複雜查詢可能有限制

- **建議方案：**
  1. **初期：** 使用 SharePoint List 作為資料庫
  2. **中期：** 若效能不足，可考慮 Vercel Postgres 或 Supabase（有免費方案）
  3. **混合方案：** 簡單數據用 SharePoint List，複雜數據用雲端資料庫

- **具體建議：**
  - 請款系統：SharePoint List 足夠
  - 船務系統：需評估數據量與查詢複雜度，可能需專業資料庫

### Q2-1: 往後真的需要專業專門的資料庫，轉移成本會很高嗎？還是初期用簡單的，真的需要時再轉換也不會太陣痛？

**A:**
- **轉移成本：** 如果架構設計得當，轉移成本不會太高
- **降低轉移成本的策略：**
  1. **抽象化資料存取層：** 建立統一的資料存取介面（Repository Pattern）
     - 初期用 SharePoint List，後期換成 PostgreSQL，只需修改資料存取層
     - 業務邏輯層完全不需要改動
  2. **使用 ORM 或資料庫抽象層：** 
     - 如 Prisma、TypeORM 等，可以輕鬆切換資料庫
  3. **資料格式標準化：** 
     - 確保資料結構一致，轉移時只需做資料遷移腳本
- **建議做法：**
  - **初期：** 使用 SharePoint List 或簡單方案（如 Vercel KV、Supabase）
  - **設計時：** 將資料存取邏輯獨立出來，不要直接寫死
  - **轉移時：** 只需修改資料存取層，其他程式碼幾乎不動
- **實際轉移時間：** 如果架構設計良好，轉移通常只需要幾天到一週
- **結論：** 初期用簡單方案完全沒問題，只要架構設計得當，轉移不會太陣痛

---

### Q3: 目前這方案需要租雲端主機嗎？有無辦法先不租？像是 Vercel（其實我對 Vercel 也不太熟，不知道他為什麼可以免費讓我們把它當主機伺服器用）

**A:**
- **不需要租雲端主機（初期）：**
  - ✅ Vercel 免費方案足夠初期開發
  - ✅ SharePoint List 作為資料庫（無需額外主機）
  - ✅ Microsoft 365 服務已包含

- **Vercel 為什麼免費：**
  - Vercel 提供免費方案給個人/小專案使用（類似 GitHub Pages）
  - 免費方案限制：每月有一定使用量限制，但對初期開發足夠
  - 商業模式：當專案成長後，提供付費方案給需要更多資源的用戶
  - **適合場景：** 靜態網站、前端應用、Serverless 函數

- **何時需要考慮付費：**
  - 使用量超過免費額度
  - 需要專用資料庫服務
  - 需要更強大的後端服務
  - 需要更多團隊協作功能

- **建議：** 先用免費方案開發，待專案穩定後再評估是否需要升級

### Q3-1: 往後希望網頁是能及時響應互動，有需要去租雲端主機/伺服器嗎？（其實我也還搞不太清楚兩者差異）

**A:**
- **雲端主機 vs 伺服器的差異：**
  1. **傳統伺服器（Dedicated Server）：**
     - 實體機器，需要自己管理硬體、作業系統、安全性
     - 固定成本，無論使用量多少都要付費
     - 需要 IT 人員維護
  2. **雲端主機（Cloud Hosting）：**
     - 虛擬機器，由雲端服務商管理硬體
     - 彈性擴充，按使用量付費
     - 自動備份、高可用性
  3. **Serverless（無伺服器）：**
     - 如 Vercel、AWS Lambda
     - 完全不需要管理伺服器
     - 按請求付費，自動擴充
- **即時響應互動的需求：**
  - **不需要租傳統伺服器！** 現代 Serverless 方案完全足夠
  - **Vercel：** 免費方案支援 Serverless Functions，可以處理即時互動
  - **WebSocket 支援：** 
    - Vercel 的 Serverless Functions 可以處理 WebSocket（需升級到 Pro 方案）
    - 或使用專門的 WebSocket 服務（如 Pusher、Ably，有免費方案）
    - 或使用 Supabase Realtime（包含在免費方案中）
- **建議方案：**
  1. **初期：** 繼續使用 Vercel 免費方案 + Supabase Realtime（免費）
  2. **成長期：** 若需要更強大的 WebSocket 支援，可考慮：
     - Vercel Pro 方案（$20/月）
     - Supabase Pro 方案（$25/月，包含即時功能）
     - 或使用專門的 WebSocket 服務
- **結論：** 
  - 不需要租傳統伺服器
  - Serverless 方案（如 Vercel）完全足夠處理即時互動
  - 成本遠低於傳統伺服器，且更易於管理

---

## 📊 開發進度追蹤

### 階段一：請款系統
- [ ] 專案初始化與環境設定
- [ ] Microsoft 365 登入整合
- [ ] 請款單介面開發
- [ ] 請款單功能實作（新增、刪除、計算）
- [ ] 權限管理系統
- [ ] 會計後台功能
- [ ] PWA 設定
- [ ] Teams 應用程式版本
- [ ] 資料庫整合（SharePoint List 或替代方案）
- [ ] 測試與優化
- [ ] 部署與上線

### 階段二：個人儀表板
- [ ] 個人檔案頁面設計
- [ ] 成就系統設計
- [ ] 勳章系統設計
- [ ] 數據視覺化
- [ ] 與船務系統串接（待階段三完成）

### 階段三：船務系統
- [ ] 需求分析與功能規劃
- [ ] 系統架構設計
- [ ] 核心功能開發
- [ ] 與現有系統數據遷移規劃
- [ ] 測試與優化
- [ ] 上線與培訓

### 階段四：官網重新設計
- [ ] 設計稿製作
- [ ] 網域設定
- [ ] 內容遷移
- [ ] 上線

---

## 📝 備註與待辦事項

### 待確認事項
- [ ] Vercel 自動部署設定狀態
- [ ] Git 倉庫位置與權限
- [ ] 網域 DNS 設定權限與流程
- [ ] SharePoint List 的具體使用方式與限制

### 重要提醒
1. **網域設定：** 每階段完成後再處理網域相關事務，初期可先用 Vercel 提供的網址
2. **資料庫選擇：** 先從 SharePoint List 開始，視需求再調整
3. **效能優化：** 持續監控與優化，確保網頁版系統反應速度
4. **Microsoft 365 整合：** 善用現有訂閱，但以專業判斷為準

---

## 🔗 相關連結

- **公司官網：** http://www.rhema.url.tw/
- **Microsoft Azure 入口：** https://portal.azure.com/
- **Vercel 儀表板：** https://vercel.com/dashboard
- **Microsoft Graph API 文件：** https://docs.microsoft.com/graph/

---

**文件維護：** 此文件應隨專案進度持續更新，確保資訊準確與完整。

